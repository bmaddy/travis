<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: ActsAsSolr::ClassMethods</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">ActsAsSolr::ClassMethods</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/class_methods_rb.html">
                lib/class_methods.rb
                </a>
        <br />
                <a href="../../files/lib/deprecation_rb.html">
                lib/deprecation.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000152">count_by_solr</a>&nbsp;&nbsp;
      <a href="#M000149">find_by_solr</a>&nbsp;&nbsp;
      <a href="#M000150">find_id_by_solr</a>&nbsp;&nbsp;
      <a href="#M000154">find_with_facet</a>&nbsp;&nbsp;
      <a href="#M000151">multi_solr_search</a>&nbsp;&nbsp;
      <a href="#M000153">rebuild_solr_index</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="CommonMethods.html">CommonMethods</a></span>
        <span class="include-name"><a href="ParserMethods.html">ParserMethods</a></span>
      </div>
    </div>

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000152" class="method-detail">
        <a name="M000152"></a>

        <div class="method-heading">
          <a href="ClassMethods.src/M000152.html" target="Code" class="method-signature"
            onclick="popupCode('ClassMethods.src/M000152.html');return false;">
          <span class="method-name">count_by_solr</span><span class="method-args">(query, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
returns the total number of documents found in the query specified:
</p>
<pre>
 Book.count_by_solr 'rails' =&gt; 3
</pre>
        </div>
      </div>

      <div id="method-M000149" class="method-detail">
        <a name="M000149"></a>

        <div class="method-heading">
          <a href="ClassMethods.src/M000149.html" target="Code" class="method-signature"
            onclick="popupCode('ClassMethods.src/M000149.html');return false;">
          <span class="method-name">find_by_solr</span><span class="method-args">(query, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Finds instances of a model. Terms are ANDed by default, can be overwritten
by using OR between terms
</p>
<p>
Here&#8216;s a sample (untested) code for your controller:
</p>
<pre>
 def search
   results = Book.find_by_solr params[:query]
 end
</pre>
<p>
You can also search for specific fields by searching for
&#8216;field:value&#8216;
</p>
<h4>options:</h4>
<table>
<tr><td valign="top">offset:</td><td>- The first document to be retrieved (offset)

</td></tr>
<tr><td valign="top">limit:</td><td>- The number of rows per page

</td></tr>
<tr><td valign="top">order:</td><td>- Orders (sort by) the result set using a given criteria:

<pre>
    Book.find_by_solr 'ruby', :order =&gt; 'description asc'
</pre>
</td></tr>
<tr><td valign="top">field_types:</td><td>This option is deprecated and will be obsolete by version 1.0.
There&#8216;s no need to specify the :field_types anymore when doing a
search in a model that specifies a field type for a field. The field types
are automatically traced back when they&#8216;re included.

<pre>
  class Electronic &lt; ActiveRecord::Base
    acts_as_solr :fields =&gt; [{:price =&gt; :range_float}]
  end
</pre>
</td></tr>
<tr><td valign="top">facets:</td><td>This option argument accepts the following arguments:

<table>
<tr><td valign="top">fields:</td><td>The fields to be included in the faceted search (<a
href="../Solr.html">Solr</a>&#8216;s facet.field)

</td></tr>
<tr><td valign="top">query:</td><td>The queries to be included in the faceted search (<a
href="../Solr.html">Solr</a>&#8216;s facet.query)

</td></tr>
<tr><td valign="top">zeros:</td><td>Display facets with count of zero. (true|false)

</td></tr>
<tr><td valign="top">sort:</td><td>Sorts the faceted resuls by highest to lowest count. (true|false)

</td></tr>
<tr><td valign="top">browse:</td><td>This is where the &#8216;drill-down&#8217; of the facets work. Accepts an
array of fields in the format &quot;facet_field:term&quot;

</td></tr>
</table>
</td></tr>
</table>
<p>
Example:
</p>
<pre>
  Electronic.find_by_solr &quot;memory&quot;, :facets =&gt; {:zeros =&gt; false, :sort =&gt; true,
                                                :query =&gt; [&quot;price:[* TO 200]&quot;,
                                                           &quot;price:[200 TO 500]&quot;,
                                                           &quot;price:[500 TO *]&quot;],
                                                :fields =&gt; [:category, :manufacturer],
                                                :browse =&gt; [&quot;category:Memory&quot;,&quot;manufacturer:Someone&quot;]}
</pre>
<table>
<tr><td valign="top">scores:</td><td>If set to true this will return the score as a &#8216;solr_score&#8217;
attribute for each one of the instances found. Does not currently work with
<a href="ClassMethods.html#M000150">find_id_by_solr</a>

<pre>
  books = Book.find_by_solr 'ruby OR splinter', :scores =&gt; true
  books.records.first.solr_score
  =&gt; 1.21321397
  books.records.last.solr_score
  =&gt; 0.12321548
</pre>
</td></tr>
</table>
        </div>
      </div>

      <div id="method-M000150" class="method-detail">
        <a name="M000150"></a>

        <div class="method-heading">
          <a href="ClassMethods.src/M000150.html" target="Code" class="method-signature"
            onclick="popupCode('ClassMethods.src/M000150.html');return false;">
          <span class="method-name">find_id_by_solr</span><span class="method-args">(query, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Finds instances of a model and returns an array with the ids:
</p>
<pre>
 Book.find_id_by_solr &quot;rails&quot; =&gt; [1,4,7]
</pre>
<p>
The options accepted are the same as <a
href="ClassMethods.html#M000149">find_by_solr</a>
</p>
        </div>
      </div>

      <div id="method-M000154" class="method-detail">
        <a name="M000154"></a>

        <div class="method-heading">
          <a href="ClassMethods.src/M000154.html" target="Code" class="method-signature"
            onclick="popupCode('ClassMethods.src/M000154.html');return false;">
          <span class="method-name">find_with_facet</span><span class="method-args">(query, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000151" class="method-detail">
        <a name="M000151"></a>

        <div class="method-heading">
          <a href="ClassMethods.src/M000151.html" target="Code" class="method-signature"
            onclick="popupCode('ClassMethods.src/M000151.html');return false;">
          <span class="method-name">multi_solr_search</span><span class="method-args">(query, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method can be used to execute a search across multiple models:
</p>
<pre>
  Book.multi_solr_search &quot;Napoleon OR Tom&quot;, :models =&gt; [Movie]
</pre>
<h4>options:</h4>
<p>
Accepts the same options as <a
href="ClassMethods.html#M000149">find_by_solr</a> plus:
</p>
<table>
<tr><td valign="top">models:</td><td>The additional models you&#8216;d like to include in the search

</td></tr>
<tr><td valign="top">results_format:</td><td>Specify the format of the results found

<table>
<tr><td valign="top">:objects :</td><td>Will return an array with the results being objects (default). Example:

<pre>
 Book.multi_solr_search &quot;Napoleon OR Tom&quot;, :models =&gt; [Movie], :results_format =&gt; :objects
</pre>
</td></tr>
<tr><td valign="top">:ids :</td><td>Will return an array with the ids of each entry found. Example:

<pre>
 Book.multi_solr_search &quot;Napoleon OR Tom&quot;, :models =&gt; [Movie], :results_format =&gt; :ids
 =&gt; [{&quot;id&quot; =&gt; &quot;Movie:1&quot;},{&quot;id&quot; =&gt; Book:1}]
</pre>
<p>
Where the value of each array is as Model:instance_id
</p>
</td></tr>
</table>
</td></tr>
</table>
        </div>
      </div>

      <div id="method-M000153" class="method-detail">
        <a name="M000153"></a>

        <div class="method-heading">
          <a href="ClassMethods.src/M000153.html" target="Code" class="method-signature"
            onclick="popupCode('ClassMethods.src/M000153.html');return false;">
          <span class="method-name">rebuild_solr_index</span><span class="method-args">(batch_size=0, &amp;finder)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
It&#8216;s used to rebuild the <a href="../Solr.html">Solr</a> index for a
specific model.
</p>
<pre>
 Book.rebuild_solr_index
</pre>
<p>
If batch_size is greater than 0, adds will be done in batches. NOTE: If
using sqlserver, be sure to use a finder with an explicit order. Non-edge
versions of rails do not handle pagination correctly for sqlserver without
an order clause.
</p>
<p>
If a finder block is given, it will be called to retrieve the items to
index. This can be very useful for things such as updating based on
conditions or using eager loading for indexed associations.
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>